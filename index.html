<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Voice instructional role-playing game generator</title>

    <meta itemprop="name" content="nocode-voice-edu-rpg">
    <meta name="description" content="Voice instructional role-playing game generator">
    <meta name="robots" content="noindex, follow">
    <meta name="keywords" content="voice, instructional role-playing game generator">
    <meta name="author" content="Jim Salsman">
    <meta name="language" content="English">
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <!-- <link rel="icon" href="icon.png"> -->
    <meta itemprop="url" content="https://jsalsman.github.io/nocode-voice-edu-rpg">
    <link rel="canonical" href="https://jsalsman.github.io/nocode-voice-edu-rpg" />

    <!-- Preview card: -->
    <meta property="og:title" content="nocode-voice-edu-rpg">
    <!-- <meta property="og:image" content="screenshot.png" /> -->
    <meta property="og:description" content="Voice instructional role-playing game generator">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jsalsman.github.io/nocode-voice-edu-rpg">
    <meta property="og:site_name" content="github:nocode-voice-edu-rpg" />
    <meta property="og:locale" content="en_US" />

  </head>
  <body>
    <h1>Voice instructional role-playing game generator</h1>

    <hr/>
    <div id="conversation"></div>
    <hr/>
    
  <script>
  // from https://docs.vapi.ai/examples/voice-widget
  // kind of want to use a <iframe> for https://vapi.ai?demo=true&shareKey=4922b20f-1964-400c-ac08-21b6889bf23d&assistantId=b9323c5b-7c81-4371-8666-4cd2a04338a5
  
  var vapiInstance = null;
  const assistant = "b9323c5b-7c81-4371-8666-4cd2a04338a5"; // assistant ID
  const apiKey = "4922b20f-1964-400c-ac08-21b6889bf23d"; // Public key from Vapi Dashboard
  const buttonConfig = { /*
    position: "bottom-right", // "bottom" | "top" | "left" | "right" | "top-right" | "top-left" | "bottom-left" | "bottom-right"
    offset: "40px", // decide how far the button should be from the edge
    width: "50px", // min-width of the button
    height: "50px", // height of the button
    idle: { // button state when the call is not active.
      color: `rgb(93, 254, 202)`, 
      type: "pill", // or "round"
      title: "Have a quick question?", // only required in case of Pill
      subtitle: "Talk with our AI assistant", // only required in case of pill
      icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone.svg`,
    },
    loading: { // button state when the call is connecting
      color: `rgb(93, 124, 202)`,
      type: "pill", // or "round"
      title: "Connecting...", // only required in case of Pill
      subtitle: "Please wait", // only required in case of pill
      icon: `https://unpkg.com/lucide-static@0.321.0/icons/loader-2.svg`,
    },
    active: { // button state when the call is in progress or active.
      color: `rgb(255, 0, 0)`,
      type: "pill", // or "round"
      title: "Call is in progress...", // only required in case of Pill
      subtitle: "End the call.", // only required in case of pill
      icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone-off.svg`,
    },
  */ 
  };

  (function (d, t) {
    var g = document.createElement(t),
      s = d.getElementsByTagName(t)[0];
    g.src =
      "https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@latest/dist/assets/index.js";
    g.defer = true;
    g.async = true;
    s.parentNode.insertBefore(g, s);

    g.onload = function () {
      vapiInstance = window.vapiSDK.run({
        apiKey: apiKey, // mandatory
        assistant: assistant, // mandatory
        config: buttonConfig, // optional
      });
      
      function log_message(message) {
        var timestamp = new Date().toLocaleString();

        // Check if the message is an object and has a "type" property
        if (typeof message === 'object' && message.type === 'conversation-update') {
            // Find the conversation div
            var conversationDiv = document.getElementById('conversation');

            // Clear the conversation div
            conversationDiv.innerHTML = '';

            // Add the timestamp
            var timestampElement = document.createElement('p');
            timestampElement.textContent = `[${timestamp}]`;
            conversationDiv.appendChild(timestampElement);

            // Loop through the conversation array
            message.conversation.forEach(entry => {
                var p = document.createElement('p');
                p.textContent = entry.content;

                // Apply different styles based on the role
                if (entry.role === 'user') {
                    p.style.fontFamily = 'serif';
                } else if (entry.role === 'assistant') {
                    p.style.fontFamily = 'sans-serif';
                }

                // Append the paragraph to the conversation div
                conversationDiv.appendChild(p);
            });
        } else {
            // Create a <pre> element for normal log messages
            var pre = document.createElement('pre');

            // Check if the message is an object
            if (typeof message === 'object') {
                // Convert the object to a string representation
                message = JSON.stringify(message, null, 2);
            }

            // Set the message with the timestamp as the text content of the <pre> element
            pre.textContent = `[${timestamp}] ${message}`;

            // Apply the desired font size and family
            pre.style.fontSize = '11pt';
            pre.style.fontFamily = 'sans-serif';

            // Append the <pre> element to the body
            document.body.appendChild(pre);
        }
      }
  
      // Function calls and transcripts will be sent via messages
      vapiInstance.on('message', (message) => {
        log_message(message);
      });

      vapiInstance.on('error', (e) => {
        console.error(e)
        log_message(e);
      });

    };
  })(document, "script");

  </script>
</body>
</html>
